<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WBPiano - Login</title>
    <link rel="stylesheet" href="./css/login.css">
    <link rel="shortcut icon" href="./img/icone_pag.png" type="image/x-icon" />
</head>
<body>
    <!-- BARRA DE NAVEGAÇÃO -->
    <div class="header">
        <div class="container">

            <div class="logo">
                <a href="./index.html"><img src="./img/logo_preto.png" alt="logo_site"></a>
            </div>

            <div class="nav">
                <ul>
                    <il><a href="./cadastro.html">Cadastrar.</a></il>
                </ul>   
            </div>

        </div>
    </div>
    <!--FIM BARRA DE NAVEGAÇÃO-->
    <!-- CADASTRO -->
    <div class="img_fundo">
        <div class="container">
            <a href="./index.html"><img src="./img/voltar.png" alt=""></a>
            
            <form class="box_cadastro" id="entrar_pag_bonus" method="post" onsubmit="return entrar()">
                <h1>
                    Login
                </h1>
            
                <h3>
                    Informe seu e-mail e senha cadastrados para acessar o conteúdo exclusivo.
                </h3> 
                <div class="dados">
                    <div class="descricao">
                        <label for="email">E-mail:</label><br>
                        <label for="senha">Senha:</label> <br>
                    </div>
                    <div class="campo">
                        <input type="text" name="login" autofocus id="email" placeholder="exemplo@domínio.com"> <br>
                        <input type="password" name="senha" autofocus id="senha" placeholder="No mínimo 8 caracteres"> <br>
                        
                    </div>
                </div>
                
                <button class="entrar">Entrar</button>
            </form>
        </div>
    </div>
    <!-- FIM CADASTRO -->
    <!--RODAPÉ-->
    <center>
        <div class="container">
            <div class="frase">
                <p> "Como teclas de um piano afinado assim é a boca harmoniosa de uma pessoa que sabe ressoar palavras de edificação." <br> Helgir Girodo
                </p>
            </div>
        </div>
        <div class="creditos">
            Felipe França
        </div>
    </center>
    <!--FIM RODAPÉ-->
</body>
</html>
<!-- <script type="text/javascript" src="./js/login.js"></script> -->
<script>
    function entrar() {
        var formulario = new URLSearchParams(new FormData(entrar_pag_bonus));
        fetch("/usuarios/autenticar", {
            method: "POST",
            body: formulario
        }).then(resposta => {
            
            if (resposta.ok) {

                resposta.json().then(json => {

                    sessionStorage.login_usuario_meuapp = json.email;
                    sessionStorage.nome_usuario_meuapp = json.prim_nome;
                    
                    window.location.href = 'piano_virtual.html';
                });

            } else {

                console.log('Erro de login!');

                response.text().then(texto => {
                    console.error(texto);
                    finalizar_aguardar(texto);
                });
            }
        });

        return false;
    }
</script>